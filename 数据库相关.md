# 一、NoSQL是非关系型数据库

# 二、redis

redis是一个免费开源的nosql产品。redis会周期性的把更新的数据写入磁盘或者把修改操作写入追加的记录文件。

redis将数据放在内存中，存取速度快，但是对持久化支持不够良好。

## 1、redis的启动

* 启动服务端：
  * redis-server
* 启动客户端：
  * redis-cli（不支持中文）；
  * redis-cli --raw（支持中文的启动方式）

## 2、redis基本操作

+  ping  测试与redis服务器是否联通

+ select   选择数据库

  * 数据库没有名称，默认16个，通过0-15来标识。
  * select 3 选择3号数据库
  * 登录到redis客户端，如果没有做任何select操作，默认选择0号数据库

  

## 3、redis的数据类型

+ redis保存的数据都是按照键值对来保存
+ 键（key）
+ 值（value）
+ 键的数据类型都是String
+ 值的数据类型有以下五种：
  * 字符串（String）
  * 哈希（hash）
  * 列表（list）
  * 无序集合（set）
  * 有序集合（zset）

## 4、字符串操作（String）

添加修改值

* set 键 值  如果键不存在是添加，如果键存在是修改

  set user1 aaa 添加一个一个键user1，值为aaa

  set user1 bbb 把键user1的值修改为bbb

* setext 键  过期时间 值，其中过期时间单位为秒   --新增键的同时设置过期时间

  setex user2 3 bbb  添加一个键user2，值为bbb，过期时间为3秒

* mset 设置多个键值对  mset 键1 值1 键2 值2...

  mset user3 ccc user4 ddd user5 eee  同时添加3个键值对

* 已有值后面追加 append 键 值

    append user1 hahaha  # 键user1的值后面追加内容hahaha，在原有基础上修改内容

* get获取值   get 键

  get user1 #获取user1对应的值

* mget获取多个值   mget  键1 键2 ...

  mget user1 user2 user3  #一次获取多个值

* 删除键及其对应的值  del 键1 键2 键n...

  del user1 user2  #同时删除user1和user2两个键和键对应的值

## 5、键相关操作

* 查找键    keys 键名  可以支持*

  keys user1  #查找键user1是否存在

  keys *   #显示所有的键      由于redis是单线程程序，按照顺序执行指令的，数据量过大时，会出现卡顿、超时。

  scan cursor [MATCH pattern] [Count count]

  scan 0  #第一次遍历查询时，cursor为0，如果数据全部查询完，返回结果的第一个数据为0。若不返回0，则以这个数据作为下一次遍历的cursor，直到返回为0，遍历结束。

* 判断键是否存在  exists 键名   如果键存在，返回1；如果不存在，返回0

  exists user1  #判断user1是否可用

* 查看键对应的值（value）的类型  type 键

  type user2  #查看user2对应的值的类型

* 设置已有键的过期时间  expire 键

  expire user2 100  #设置user2的过期时间为100秒

* 查看键过期时间  ttl user1 返回-1，永远有效；返回值>0，剩余有效时间，单位为秒；返回值-2，键不存在

## 6、哈希（hash）操作

hash用于存储”键值对“集合；每个哈希中的键可以理解为字段（field），一个字段（field）对应一个值（value）；hash中值（value）类型为字符串（String）；同一个哈希中字段名（field）不可以重复。

* 添加值   hset key（键） field（字段） value（值）

  hset huser1 name tom  #增加一个hash类型的键值对，字段为name，值为tom

* 添加多个值  hmset 键 字段1 值1 字段2 值2...

  hmset huser2 name mary sex female  #添加一个huser2的键，字段有两个   

* type 查看hash类型的值

  type huser2

* 获取指定键的所有字读(field)名    hkeys 键

  hkeys huser2  #获取键huser2所有的字段

* 获取字段对应的值  hget 键 字段

  hget huser2 name  #获取键huser2，字段name的值

* 获取多个字段的值   hmget 键 字段1 字段2...

  hmget huser2 name sex  # 获取huser2的name和sex字段的值

* 获取所有字段的值    hvals 键

  hvals huser2   #获取huser2所有字段的值

* 获取所有字段名包括值  hgetall 键

  hgetall huser2  #获取huser2所有的字段名和值

* 删除hash中指定字段   hdel 键名 字段名

  hdel huser2 sex   #把键huser2的字段sex删除

* 删除整个hash键及其对应的字段和值   del 键

  del huser1   #删除整个huser1的键

## 7、列表（list）操作

列表中的值（value）类型为字符串；列表中每个值按照添加的顺序排列

* 从列表左侧添加值   lpush key value1 value2...

  lpush luser1 aa   #新建luser1，左侧添加值aaa

* 从右侧添加值   lpush key value1 value2...

  rpush luser1 bb cc dd   #从列表右侧添加三个值，bb  cc  dd

* 在指定值的前面或后面插入值   linsert key before或after 值   插入的值

  linsert luser1 before cc 11  #在键luser的列表值 cc 前加入值 11

  linsert luser1 after cc 22   ## 在cc后面插入新值22

* 获取列表值  lrange key start stop

  返回列表里指定范围内的值：索引从左侧开始，第一个值的索引为0；索引可以是负数，表示从尾部开始计数，如：-1表示最后一个值。

  start代表开始索引，stop结束索引；

  lrange luser1 0 -1  #获取列表中所有的值

  lrange luser1 2 4  #从第三个元素到第五个元素的值

  lrange luser1 3 -1  #从第四个元素开始到最后一个元素的值

* 修改值  lset key index value

  设置指定索引位置的值，索引从左侧开始，第一个值的索引为0；索引可以是负数，表示从尾部开始，-1代表最后一个值

  lset luser1 1 china  #把第二个元素的值改为china

* 删除指定值   lrem key count value

  将列表中前count次出现的值移除；count>0：从头往尾删除；count<0：从尾往头删除；count=0：删除所有值

  lrem luser2 -1 h0   #从后往前，从右往左，删除键luser2列表中的一个h0

  lrem luser2 0 h0   #删除键luser2列表中所有的h0

## 8、无序集合（set）操作

无序集合中值（value）类型为字符串；集合中不允许有重复的值；说明：对于集合中的值只能添加与删除，不能修改。

* 集合中添加值  sadd key value1 value2...

  sadd suser1 aa bb cc  #添加三个值

* 获取集合中的值   smembers key

  smembers suser1   #获取键suer1所有的值

* 删除集合中的值   srem key value 

  srem suser1 cc   #删除键suer1的值cc

## 9、有序集合（zset）操作

有序集合中值（value）类型为字符串；集合中不允许有重复的值；每个值都会关联一个分数（score），分数可以为负数，通过分数将值从小到大排序；  说明：对于有序集合中的值只能添加与删除，不能修改。

* 有序集合中添加值   zadd key score1 value1 score2 value2...

  zadd zuser1 1 aa 3 dd 6 cc 2 ff  #添加三个值，score分别为1，3，6，2；添加的值会按照score从小到大排序

* 获取指定范围的值   zrange key start stop [withscores]

  start,stop为值的下标索引；第一个值的索引为0；索引可以是负数，表示从尾部开始计数，-1表示最后一个值；withscores指同时获取对应分数（score），可选项

  zrange zuser1 0 -1 wihtscores   #获取键zuser1的所有值，并显示相应的score

* 通过score获取值

  返回分数（score）在min（起始值）和max（结束值）之间的值    zrangbyscore key min max

  zrangebyscore zuser1 2 6  #获取score从2到6之间的值

* 通过值得到score   zscore key value 

   zscore zuser1 dd  #得到值dd的score

* 删除指定值      zrem key value1 value2...

  zrem zuser1 dd   #删除键zuser1中的值dd

* 通过score删除值   

  删除分数（score）在指定范围之间的值     zremrangebyscore key min max

  zremrangebyscore zuer1 0 10   #score从0到10之间的值都删除

总结：

<img src="%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3.assets/image-20201229115002135.png" alt="image-20201229115002135" style="zoom:50%;" />

# 三、mysql（关系型数据库）

测试工程师在测试软件的过程中，不仅需要在界面上操作，还需要检查数据库中的数据是否正确，从而测出更深层的软件问题。

常用的关系型数据库：oracle、mysql、Microsoft SQL Server、SQLite

数据库（表的集合，一个数据库中能够有多个表）；表（由行和列组成的二维表格）；行（记录）；列（字段）

SQL语言：

DQL：数据查询语言，用于对数据进行查询，如select

DDL：数据定义语言，进行数据库、表的管理等，如create、drop；

DML：数据操作语言，对数据进行增、删、改，如：insert、update、delete；

TPL：事务处理语言，对事务进行处理，包括begin transaction,commit,rollback;

使用navicat连接mysql，新建数据库。

## 1、sql语言中的注释

* -- 行注释
* /*  注释内容 */

ctrl +/ 可以快速注释

## 2、mysql常用数据类型

* 整数：int。有符号范围（-2147483648，2147483647），无符号范围（0，4294967295）。如：int unsigned，代表设置一个无符号的整数；
* 小整数：tinyint。有符号范围（-128，127）。无符号范围（0，255）。如：tinyint unsigned，代表设置一个无符号的小整数；
* 小数：decimal，如decimal(5,2)表示共存5位数，小数占2位，不能超过2位；整数占3位，不能超过三位；
* 字符串：varchar，如varchar(3)表示最多存3个字符，一个中文或一个字母都占一个字符；
* 日期时间：datetime，范围(1000-01-01 00:00:00~9999-12-31 23:59:59)，如'2020-01-01 12:29:59'

## 3、数据库元素单词说明

数据库--database

表（table）：数据库中存储数据的基本单位，表是一个由行和列组成的二维表格结构。

字段（field）：表中的列，在数据库中，叫做字段（field）。

记录（record）：表中的一行，在数据库中，叫做记录（record）。

## 4、表相关操作

* create table 创建表

  create table 表名（字段名 数据类型（字段长度） 约束，字段名 字段类型（字段长度）） 约束

* insert插入所有字段值  insert into 表名 values (值，值...);

  insert into c values (1,'张飞',30);

* insert插入指定字段值  insert into 表名 (字段名1,...) values (值1,...)

  insert into c (id,name) values (1,'曹操');

* 一条insert语句，插入多条记录    insert into 表名 values (),(),();

  insert into c values (2,'张三',10),(3,'李四',11),(4,'王五',12);

* 一条insert语句，插入多条指定字段的记录   insert into 表名 (字段名，字段名) values (值，值),(值，值),(值，值)

* select查询表    

  select * from 表名

  select查询指定字段   select 字段名 from 表名

* update 修改数据   update 表名 set 字段1=值,字段2=值... where 条件；

  update c set age=age+1 where id>3;  #对id>3的记录，长一岁

* delete 删除记录  delete from 表名 where 条件；

  delete from c where id=6;

* truncate删除表的所有数据     truncate table 表名

速度上，truncate>delete;

删除部分数据用delete，注意带上where子句；

如果想保留表而将所有数据删除，自增长字段恢复从1开始，用truncate;delete会从原有自增长字段id开始

* drop 删除表   drop table 表名；

  drop table if exists 表名；  #如果表存在就删除，不存在就不做任何操作

## 5、字段的约束

主键(primary key)：值不能重复，auto_increment代表值自动增长（不用设置）；

非空（not null）：此字段不允许填写空值；

唯一（unique）：此字段的值不允许重复；

默认值（default）：当不填写此值时会使用默认值，

* 主键（primary key）    
  * 主键的值不能重复（具备unique特性），auto_increment 值会系统自动维护，自动增长

-- 创建表d，字段要求：id：数据类型为 int unsigned（无符号整数），primary key（主键），auto_increment(自增长）；name 姓名，varchar 长度10；age 年龄 int
create table d(
	id int unsigned **primary key auto_increment**,
	name varchar(10),
	age int
);
insert into d (name,age) values ('张飞',30);

如果不指定字段，主键自增长字段的值可以用占位符，0或者null

insert into d values (0,'王三',20);
insert into d values (null,'李四',30);

* 非空约束（not null）
  * 该字段必须有值，如果没有值，insert插入会失败。

create table e(
	id int unsigned,
	name varchar(10) **not null**,
	age int
);

* 唯一约束（unique）
  * 该字段的值不允许重复

```sql
create table f (
	id int,
	name varchar(10) unique,
	age int
);
```

* 默认值（default 值）

  当一个字段有默认值约束，插入数据时，如果指定了值，那么默认值无效；如果没有指定值，会使用默认值

```sql
create table g (
	id int,
	name varchar(10),
	age int default 30
);
insert into g values (1,'张三',20);
insert into g(id,name) values (2,'李四');
select * from g;
```

<img src="%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9B%B8%E5%85%B3.assets/image-20210105164741038.png" alt="image-20210105164741038" style="zoom:80%;" />

